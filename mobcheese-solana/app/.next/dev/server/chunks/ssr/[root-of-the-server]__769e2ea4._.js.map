{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/mobcheese-economy/mobcheese-solana/app/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport dynamic from \"next/dynamic\";\nimport { useWallet, useConnection } from \"@solana/wallet-adapter-react\";\nimport * as anchor from \"@coral-xyz/anchor\";\nimport { PublicKey, SystemProgram } from \"@solana/web3.js\";\nimport { \n  TOKEN_PROGRAM_ID, \n  getAssociatedTokenAddress as getAssociatedTokenAddressOrig \n} from \"@solana/spl-token\";\n\n// Wrapper to handle both sync and async versions\nconst getAssociatedTokenAddress = async (mint: PublicKey, owner: PublicKey) => {\n  const { getAssociatedTokenAddressSync } = await import(\"@solana/spl-token\");\n  return getAssociatedTokenAddressSync(mint, owner);\n};\n\nconst WalletMultiButton = dynamic(\n  () =>\n    import(\"@solana/wallet-adapter-react-ui\").then(\n      (mod) => mod.WalletMultiButton\n    ),\n  { ssr: false }\n);\n\nexport default function Home() {\n  const { connection } = useConnection();\n  const wallet = useWallet();\n  const [txSig, setTxSig] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  // Load from environment variables\n  const programIdStr = process.env.NEXT_PUBLIC_PROGRAM_ID || \"F8MN4tsJWJpRmnBsXZ4i99CkJ9TEWnNsgqqSGJHQdhzz\";\n  const mintStr = process.env.NEXT_PUBLIC_MINT_ADDRESS || \"\";\n  const treasuryStr = process.env.NEXT_PUBLIC_TREASURY_ADDRESS || \"\";\n\n  // Check if configuration is valid\n  const isConfigured = mintStr && treasuryStr && \n    !mintStr.includes(\"YOUR_\") && \n    !treasuryStr.includes(\"YOUR_\");\n\n  const joinFamily = async () => {\n    if (!wallet.publicKey) {\n      setError(\"Please connect your wallet first!\");\n      return;\n    }\n\n    setLoading(true);\n    setError(\"\");\n    setTxSig(\"\");\n\n    try {\n      // Validate environment configuration\n      if (!isConfigured) {\n        throw new Error(\n          \"Please configure your environment:\\n\" +\n          \"1. Create app/.env.local file\\n\" +\n          \"2. Set NEXT_PUBLIC_MINT_ADDRESS\\n\" +\n          \"3. Set NEXT_PUBLIC_TREASURY_ADDRESS\\n\" +\n          \"See DEPLOYMENT.md for details\"\n        );\n      }\n\n      // Create PublicKey objects only after validation\n      const PROGRAM_ID = new PublicKey(programIdStr);\n      const MINT = new PublicKey(mintStr);\n      const TREASURY = new PublicKey(treasuryStr);\n\n      const provider = new anchor.AnchorProvider(connection, wallet as any, {\n        preflightCommitment: \"processed\",\n      });\n\n      const idl = await anchor.Program.fetchIdl(PROGRAM_ID, provider);\n      if (!idl) throw new Error(\"IDL not found for program\");\n\n      const program = new anchor.Program(idl, provider);\n\n      // PDA for membership\n      const [memberPDA] = PublicKey.findProgramAddressSync(\n        [Buffer.from(\"mobcheese\"), wallet.publicKey.toBuffer()],\n        PROGRAM_ID\n      );\n\n      // Treasury authority PDA\n      const [treasuryAuthority] = PublicKey.findProgramAddressSync(\n        [Buffer.from(\"treasury\")],\n        PROGRAM_ID\n      );\n\n      // Associated token account for user\n      const userTokenAccount = await getAssociatedTokenAddress(\n        MINT,\n        wallet.publicKey\n      );\n\n      const tx = await program.methods\n        .joinFamily()\n        .accounts({\n          member: memberPDA,\n          user: wallet.publicKey,\n          userTokenAccount,\n          treasury: TREASURY,\n          treasuryAuthority,\n          mint: MINT,\n          tokenProgram: TOKEN_PROGRAM_ID,\n          systemProgram: SystemProgram.programId,\n        })\n        .rpc();\n\n      setTxSig(tx);\n      setError(\"\");\n    } catch (err: any) {\n      console.error(\"Transaction error:\", err);\n      \n      // Handle specific error codes\n      if (err.toString().includes(\"AlreadyMember\")) {\n        setError(\"You are already a member of the MobCheese family!\");\n      } else if (err.toString().includes(\"insufficient funds\")) {\n        setError(\"Insufficient SOL for transaction fees\");\n      } else if (err.toString().includes(\"InvalidTokenAccount\")) {\n        setError(\"Invalid token account - please create one first\");\n      } else {\n        setError(err.message || \"Transaction failed. Please try again.\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ textAlign: \"center\", marginTop: \"50px\", padding: \"20px\" }}>\n      <h1 style={{ color: \"white\", marginBottom: \"20px\", fontSize: \"2.5rem\" }}>\n        Join the MobCheese Family üßÄ\n      </h1>\n      \n      <div style={{ marginBottom: \"30px\" }}>\n        <WalletMultiButton />\n      </div>\n\n      {!isConfigured && (\n        <div\n          style={{\n            marginTop: \"20px\",\n            padding: \"20px\",\n            background: \"rgba(255, 193, 7, 0.9)\",\n            borderRadius: \"12px\",\n            maxWidth: \"600px\",\n            margin: \"20px auto\",\n            color: \"#333\",\n          }}\n        >\n          <h3 style={{ marginBottom: \"10px\", fontSize: \"20px\" }}>\n            ‚öôÔ∏è Configuration Required\n          </h3>\n          <p style={{ marginBottom: \"10px\" }}>\n            To enable the app, create <code>app/.env.local</code> with:\n          </p>\n          <pre\n            style={{\n              background: \"#fff\",\n              padding: \"10px\",\n              borderRadius: \"5px\",\n              overflow: \"auto\",\n              fontSize: \"12px\",\n            }}\n          >\n            {`NEXT_PUBLIC_PROGRAM_ID=${programIdStr}\nNEXT_PUBLIC_MINT_ADDRESS=<your-mint-address>\nNEXT_PUBLIC_TREASURY_ADDRESS=<your-treasury-address>`}\n          </pre>\n          <p style={{ marginTop: \"10px\", fontSize: \"14px\" }}>\n            See <strong>DEPLOYMENT.md</strong> for setup instructions\n          </p>\n        </div>\n      )}\n\n      {wallet.publicKey && isConfigured && (\n        <>\n          <button\n            onClick={joinFamily}\n            disabled={loading}\n            style={{\n              padding: \"15px 30px\",\n              fontSize: \"18px\",\n              marginTop: \"20px\",\n            }}\n          >\n            {loading ? \"Processing...\" : \"Join the Family\"}\n          </button>\n\n          {error && (\n            <div\n              style={{\n                marginTop: \"20px\",\n                padding: \"15px\",\n                background: \"#fee\",\n                borderRadius: \"8px\",\n                color: \"#c33\",\n                maxWidth: \"500px\",\n                margin: \"20px auto\",\n                whiteSpace: \"pre-wrap\",\n              }}\n            >\n              ‚ö†Ô∏è {error}\n            </div>\n          )}\n\n          {txSig && (\n            <div\n              style={{\n                marginTop: \"20px\",\n                padding: \"20px\",\n                background: \"rgba(255, 255, 255, 0.9)\",\n                borderRadius: \"12px\",\n                maxWidth: \"500px\",\n                margin: \"20px auto\",\n              }}\n            >\n              <h3 style={{ color: \"#4caf50\", marginBottom: \"10px\" }}>\n                ‚úÖ Welcome to the Family!\n              </h3>\n              <p>\n                <a\n                  href={`https://solscan.io/tx/${txSig}?cluster=devnet`}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                  style={{\n                    color: \"#667eea\",\n                    fontWeight: \"bold\",\n                    fontSize: \"16px\",\n                  }}\n                >\n                  View Transaction on Solscan ‚Üí\n                </a>\n              </p>\n            </div>\n          )}\n        </>\n      )}\n\n      {!wallet.publicKey && isConfigured && (\n        <p style={{ color: \"white\", marginTop: \"20px\", fontSize: \"18px\" }}>\n          Connect your wallet to join the family\n        </p>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}